<template>
  <div>
    <Loader v-if="loader" />
    <section class="section main-section">
      <div class="container">
        <div class="main__wrapper">
          <ul class="main__menu">
            <ul class="main__menu-item main-section__catalog">
              –ö–∞—Ç–∞–ª–æ–≥ –∏–≥—Ä—É—à–µ–∫
              <i class="fas fa-angle-down"></i>
              <div>
                <nuxt-link 
                  tag="li"
                  v-for="(item, index) in categories" 
                  :key="item.name" 
                  :to="`/catalog?category=${index+1}`" 
                  class="main-section__catalog-item"
                >
                  {{ item.name }}
                </nuxt-link>
              </div>
            </ul>
            <li class="main__menu-item">
              <nuxt-link to="/catalog?gender=2">–ú–∞–ª—ã—à–∞–º</nuxt-link>
            </li>
            <li class="main__menu-item">
              <nuxt-link to="/catalog?gender=1">–ú–∞–ª—å—á–∏–∫–∞–º</nuxt-link>
            </li>
            <li class="main__menu-item">
              <nuxt-link to="/catalog?gender=0">–î–µ–≤–æ—á–∫–∞–º</nuxt-link>
            </li>
            <li class="main__menu-item">
              <a href="#age">–í–æ–∑—Ä–∞—Å—Ç</a>
            </li>
          </ul>
        </div>
      </div>
    </section>

    <section class="section slider">
      <div class="container">
        <div class="slider__wrapper">
          <swiper ref="mySwiper" :options="swiperOptions">
            <swiper-slide>
              <nuxt-link tag="div" to="/catalog" style="cursor: pointer;">
                <img src="@/assets/images/1.png" alt="image">
              </nuxt-link>
            </swiper-slide>
            <swiper-slide>
              <nuxt-link tag="div" to="/catalog" style="cursor: pointer;">
                <img src="@/assets/images/2.png" alt="image">
              </nuxt-link>
            </swiper-slide>
            <swiper-slide>
              <nuxt-link tag="div" to="/catalog" style="cursor: pointer;">
                <img src="@/assets/images/3.png" alt="image">
              </nuxt-link>
            </swiper-slide>
            <swiper-slide>
              <nuxt-link tag="div" to="/catalog" style="cursor: pointer;">
                <img src="@/assets/images/4.png" alt="image">
              </nuxt-link>
            </swiper-slide>
            <div class="swiper-pagination" slot="pagination"></div>
            <div class="swiper-button-prev" slot="button-prev"></div>
            <div class="swiper-button-next" slot="button-next"></div>
          </swiper>
        </div>
      </div>
    </section>
    
    <section class="section newProducts">
      <div class="container">
        <div class="newProducts__wrapper">
          <div class="section__title">
            <h2>–•–∏—Ç—ã –ø—Ä–æ–¥–∞–∂</h2>
          </div>
          <div class="newProducts__items">
            <swiper ref="mySwiperNew" :options="swiperOptionsNew">
              <swiper-slide 
                v-for="item in newProducts" 
                :key="item.id" 
                @click="toDetailProduct(item.id)"
              >
                <nuxt-link class="newProducts__item" :to="'/catalog/' + item.id">
                  <div v-if="item.sale != 0" class="newProducts__item-discount">
                    <span class="discount-value">
                      -{{ item.sale }}%
                    </span>
                  </div>
                  <img :src="item.product_image[0].image" :alt="item.product_image[0]">
                  <div class="newProducts__item-content">
                    <span>–∞—Ä—Ç. {{ item.article }}</span>
                    <h4>{{ item.name }}</h4>
                  </div>
                  <template v-if="item.sale != 0">
                    <div class="newProducts__item-price">
                      <h3>{{ $numberWithCommas(item.sale_price) }}</h3>
                      <span>
                        {{ $numberWithCommas(item.price) }}
                      </span>
                    </div>
                  </template>
                  <template v-else>
                    <div class="newProducts__item-price">
                      <h3>{{ $numberWithCommas(item.price) }}</h3>
                    </div>
                  </template>
                  <button class="btn newProducts__button">
                    –ü–µ—Ä–µ–π—Ç–∏
                  </button>
                </nuxt-link>
              </swiper-slide>
              <div class="swiper-pagination" slot="pagination"></div>
            </swiper>
          </div>
        </div>
      </div>
    </section>

    <section id="age" class="section age">
      <div class="container">
        <div class="age__wrapper">
          <div class="section__title">
            <h2>–ü–æ–∫—É–ø–∞–π—Ç–µ –∏–≥—Ä—É—à–∫–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É</h2>
          </div>
          <div class="age__content">
            <div class="age__item">
              <nuxt-link to="/catalog/?age=0" class="age__item-body">
                <span>0-12</span>
                <span>–ú–µ—Å—è—Ü–µ–≤</span>
              </nuxt-link>
            </div>
            <div class="age__item">
              <nuxt-link tag="div" to="/catalog/?age=1" class="age__item-body">
                <span>1-3</span>
                <span>–ì–æ–¥–∞</span>
              </nuxt-link>
            </div>
            <div class="age__item">
              <nuxt-link tag="div" to="/catalog/?age=2" class="age__item-body">
                <span>4-5</span>
                <span>–õ–µ—Ç</span>
              </nuxt-link>
            </div>
            <div class="age__item">
              <nuxt-link tag="div" to="/catalog/?age=3" class="age__item-body">
                <span>6-8</span>
                <span>–õ–µ—Ç</span>
              </nuxt-link>
            </div>
            <div class="age__item">
              <nuxt-link tag="div" to="/catalog/?age=4" class="age__item-body">
                <span>9-12</span>
                <span>–õ–µ—Ç</span>
              </nuxt-link>
            </div>
            <div class="age__item">
              <nuxt-link tag="div" to="/catalog/?age=5" class="age__item-body">
                <span>12+</span>
                <span>–õ–µ—Ç</span>
              </nuxt-link>
            </div>
          </div>
        </div>
      </div>
    </section>


    <section class="section popular">
      <div class="container">
        <div class="popular__wrapper">
          <div class="section__title">
            <h2>–°–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–≥—Ä—É—à–∫–∏</h2>
          </div>
          <div class="popular__items">
            <swiper ref="mySwiperPopular" :options="swiperOptionsPopular">
              <swiper-slide 
                v-for="item in popularProducts"
                :key="item.id"
              >
                <nuxt-link class="popular__item" :to="'/catalog/' + item.id">
                  <div v-if="item.sale != 0" class="popular__item-discount">
                    <span class="discount-value">
                      -{{ item.sale }}%
                    </span>
                  </div>
                  <img :src="item.product_image[0].image" :alt="item.product_image[0]">
                  <div class="popular__item-content">
                    <span>–∞—Ä—Ç. {{ item.article }}</span>
                    <h4>{{ item.name }}</h4>
                  </div>
                  <template v-if="item.sale != 0">
                    <div class="popular__item-price">
                      <h3>{{ $numberWithCommas(item.sale_price) }}</h3>
                      <span>
                        {{ $numberWithCommas(item.price) }}
                      </span>
                    </div>
                  </template>
                  <template v-else>
                    <div class="popular__item-price">
                      <h3>{{ $numberWithCommas(item.price) }}</h3>
                    </div>
                  </template>
                  <button class="btn popular__button">
                    –ü–µ—Ä–µ–π—Ç–∏
                  </button>
                </nuxt-link>
              </swiper-slide>
              <div class="swiper-pagination" slot="pagination"></div>
            </swiper>
          </div>
        </div>
      </div>
    </section>

    <section class="section reviews">
      <div class="container">
        <div class="reviews__wrapper">
          <div class="section__title">
            <h2>–û—Ç–∑—ã–≤—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π</h2>
          </div>
          <div class="reviews__items">
            <swiper ref="mySwiperReviews" :options="swiperOptionsReviews">
              <swiper-slide class="reviews__item">
                <p>–°–ø–∞—Å–∏–±–æ –∑–∞–º–∑–∞–º —Ç–æ–ª—å–∫–æ —É –≤–∞—Å –∑–∞–∫–∞–∑—ã–≤–∞—é –∏–≥—Ä—É—à–∫–∏ –≤—Å–µ–≥–¥–∞ —Ü–µ–ª—ã–µ –∏ —Ä–∞–±–æ—á–∏–µ –∏–≥—Ä—É—à–∫–∏ 
                  üëçüèΩ –¥–µ—Ç—è–º —Ä–∞–¥–æ—Å—Ç—å –∏ –º—ã –¥–æ–≤–æ–ª—å–Ω—ã
                </p>
                <h4>–ê–ª–µ–Ω–∞</h4>
              </swiper-slide>
              <swiper-slide class="reviews__item">
                <p>–∑–∞–º–∑–∞–º —Å–ø–∞—Å–∏–±–æ! –î–æ–º –±–æ–ª—å—à–æ–π –∏ —à–∏–∫–∞—Ä–Ω—ã–π –≥–∏—Ä–ª—è–Ω–¥–∞ –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ –Ω–∞—Å –æ—á–µ–Ω—å –ø–æ—Ä–∞–¥–æ–≤–∞–ª–∞! 
                  –ü–æ–¥–∞—Ä–∏–ª–∏ –Ω–∞ –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, —Å–ø—É—Å—Ç—è –ø–æ–ª—Ç–æ—Ä–∞ –º–µ—Å—è—Ü–∞ –µ—â—ë –∏–≥—Ä–∞–µ–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
                </p>
                <h4>–õ—è–∑–∑–∞—Ç</h4>
              </swiper-slide>
              <swiper-slide class="reviews__item">
                <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –±—ã—Å—Ç—Ä—É—é –¥–æ—Å—Ç–∞–≤–∫—É –∏ –∑–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ –µ–∑–¥–∏—Ç—å –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞–º! 
                  –•–æ—Ä–æ—à–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–≥—Ä—É—à–∫–∏ –Ω–∞ –ª—é–±–æ–π –≤–æ–∑—Ä–∞—Å—Ç
                </p>
                <h4>–°–≤–µ—Ç–∞</h4>
              </swiper-slide>
              <swiper-slide class="reviews__item">
                <p>–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ –±–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ —Å—ã–Ω –æ—á–µ–Ω—å 
                  —Ä–∞–¥ –Ω–æ–≤—ã–º –∏–≥—Ä—É—à–∫–∞–ºüòä –ø—Ä–æ—Å—Ç–æ –≤–æ—Å—Ç–æ—Ä–≥–µ! 
                  –ö–∞—á–µ—Å—Ç–≤–æ –æ—Ç–ª–∏—á–Ω–æ–µ –¥–æ—Å—Ç–∞–≤–∫–∞ –±—ã—Å—Ç—Ä–∞—è —Å—Ç–∞–≤–ª—é –ø—è—Ç—å üñê –∑–≤—ë–∑–¥ 
                </p>
                <h4>–ö–∞—Ä–∏–Ω–∞</h4>
              </swiper-slide>
              <swiper-slide class="reviews__item">
                <p>–°–ø–∞—Å–∏–±–æ –∑–∞–º–∑–∞–º –∑–∞ —à–∏–∫–∞—Ä–Ω—ã–µ –∏–≥—Ä—É—à–∫–∏ –∑–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç. 
                  –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–≥—Ä—É—à–∫–∏ –∑–∞ –ø—Ä–∏–µ–º–ª–µ–º—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ 
                  –¥–æ—Å—Ç–∞–≤–∫–∞ –±—ã—Å—Ç—Ä–∞—è
                </p>
                <h4>–í–µ—Ä—É—Å–∏–∫</h4>
              </swiper-slide>
            </swiper>
          </div>
        </div>
      </div>
    </section>
  </div>
</template>

<script>
export default {
  components: {
    Loader: () => import('@/components/Loader.vue')
  },
  data() {
    return {
      loader: false,
      swiperOptions: {
        loop: true,
        autoplay: {
          delay: 2500,
          disableOnInteraction: false
        },
        pagination: {
          el: '.swiper-pagination'
        },
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev'
        }
      },
      swiperOptionsNew: {
        loop: true,
        pagination: {
          el: '.swiper-pagination'
        },
        autoplay: {
          delay: 2500,
          disableOnInteraction: false
        },
        slidesPerView: 3,
        spaceBetween: 30,
        breakpoints: {
          768: {
            slidesPerView: 3,
            spaceBetween: 20
          },
          540: {
            slidesPerView: 2,
            spaceBetween: 20
          },
          320: {
            slidesPerView: 1,
            spaceBetween: 10
          }
        }
      },
      swiperOptionsPopular: {
        loop: true,
        pagination: {
          el: '.swiper-pagination'
        },
        autoplay: {
          delay: 2500,
          disableOnInteraction: false
        },
        slidesPerView: 3,
        spaceBetween: 30,
        breakpoints: {
          768: {
            slidesPerView: 3,
            spaceBetween: 20
          },
          540: {
            slidesPerView: 2,
            spaceBetween: 20
          },
          320: {
            slidesPerView: 1,
            spaceBetween: 10
          }
        }
      },
      swiperOptionsReviews: {
        loop: true,
        pagination: {
          el: '.swiper-pagination'
        },
        autoplay: {
          delay: 2500,
          disableOnInteraction: false
        },
        slidesPerView: 3,
        spaceBetween: 30,
        breakpoints: {
          768: {
            slidesPerView: 3,
            spaceBetween: 20
          },
          540: {
            slidesPerView: 2,
            spaceBetween: 20
          },
          320: {
            slidesPerView: 1,
            spaceBetween: 10
          }
        }
      }
    }
  },
  computed: {
    swiper() {
      return this.$refs.mySwiper.$swiper
    },
    swiperNew() {
      return this.$refs.mySwiperNew.$swiper
    },
    swiperPopular() {
      return this.$refs.mySwiperPopular.$swiper
    },
    swiperReviews() {
      return this.$refs.mySwiperReviews.$swiper
    },
    newProducts() {
      return this.$store.getters["product/newProducts"]
    },
    popularProducts() {
      return this.$store.getters["product/popularProducts"]
    },
    categories() {
      return this.$store.getters["product/categories"];
    },
  },
  mounted() {
    this.loader = true
    this.$store.dispatch("product/fetchCategories");
    this.$store.dispatch("product/fetchNewProducts");
    this.$store.dispatch("product/fetchPopularProducts")
    setTimeout(() => {
      this.loader = false
    }, 1500)
  },
}
</script>
